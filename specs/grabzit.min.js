function GrabzIt(a){return new function(a){this.key=a,this.data=null,this.dataKey=null,this.options=null,this.post=!1,this.elem=null,this.ConvertURL=function(a,b){return this.data=a,this.dataKey="url",this.options=this._cleanOptions(b),this.post=!1,this},this.ConvertHTML=function(a,b){return this.data=a,this.dataKey="html",this.options=this._cleanOptions(b),this.post=!0,this},this._cleanOptions=function(a){if(null==a)return{};var b={};for(var c in a)null!=c&&(b[c.toLowerCase()]=a[c]);return b},this._createXHTTP=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},this._post=function(a){var b=this._createXHTTP(),c=this;b.onreadystatechange=function(){4==this.readyState&&200==this.status&&c.elem.appendChild(c._handlePost(JSON.parse(this.responseText)))},b.open("POST",this._getBaseWebServiceUrl(),!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),b.send(a)},this._getRootURL=function(){var a="//";return"https:"!=window.location.protocol&&"http:"!=window.location.protocol&&(a="http://"),a+"api.grabz.it/services/"},this._getBaseWebServiceUrl=function(){return this._getRootURL()+"javascript.ashx"},this._createQueryString=function(a,b){var c="key="+encodeURIComponent(this.key)+"&"+a+"="+encodeURIComponent(b);for(var d in this.options){if("format"!=d&&"cache"!=d&&"customwatermarkid"!=d&&"quality"!=d&&"country"!=d&&"filename"!=d&&"errorid"!=d&&"errorclass"!=d&&"onfinish"!=d&&"onerror"!=d&&"delay"!=d&&"bwidth"!=d&&"bheight"!=d&&"height"!=d&&"width"!=d&&"target"!=d&&"requestas"!=d&&"download"!=d&&"suppresserrors"!=d&&"displayid"!=d&&"displayclass"!=d&&"background"!=d&&"pagesize"!=d&&"orientation"!=d&&"includelinks"!=d&&"includeoutline"!=d&&"title"!=d&&"coverurl"!=d&&"mtop"!=d&&"mleft"!=d&&"mbottom"!=d&&"mright"!=d&&"tabletoinclude"!=d&&"includeheadernames"!=d&&"includealltables"!=d&&"start"!=d&&"duration"!=d&&"speed"!=d&&"fps"!=d&&"repeat"!=d&&"reverse"!=d&&"templateid"!=d&&"noresult"!=d&&"hide"!=d)throw"Option "+d+" not recognized!";var e=this.options[d];null!=e&&(c+="&"+d+"="+encodeURIComponent(e))}return c},this._createScriptNode=function(a){var b=document.createElement("script");return b.src=a,b},this._handlePost=function(a){if(null!=a){if(null==a.ID||""==a.ID)throw a.Message;return this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString("id",a.ID))}},this.DataURI=function(a){var b=null;null!=this.options.onfinish&&(b=this.options.onfinish);var c="grabzItCallback"+Math.floor(Math.random()*(1e9+1));this.options.onfinish=c,this.options.noresult=1;var d=this;window[c]=function(c){var e=d._createXHTTP();e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var d=new FileReader;d.onload=function(d){if(null!=a&&a(d.target.result),null!=b){var e=new Function(b+"('"+c+"')");e()}},d.readAsDataURL(this.response)}},e.open("GET",d._getRootURL()+"getjspicture.ashx?id="+c,!0),e.responseType="blob",e.send()},this.Create()},this.Create=function(){var a=document.documentElement;null!=document.body&&(a=document.body),this.AddTo(a)},this.AddTo=function(a){if("string"==typeof a||a instanceof String){if(this.elem=document.getElementById(a),null==this.elem)throw"An element with the id "+a+" was not found"}else 1===a.nodeType&&(this.elem=a);if(null==this.elem)throw"No valid element was provided to attach the screenshot to";return"1"!=this.options.download&&delete this.options.download,this.post?void this._post(this._createQueryString(this.dataKey,this.data)):void this.elem.appendChild(this._createScriptNode(this._getBaseWebServiceUrl()+"?"+this._createQueryString(this.dataKey,this.data)))}}(a)}